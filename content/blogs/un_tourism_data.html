---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-09-30"
description: UN Tourism Data # the title that will show up once someone gets to this page
draft: false
image: tourism.jpeg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: UN_Tourism_Data # slug is the shorthand URL address... no spaces plz
title: UN Tourism Data
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="load-libraries" class="section level2">
<h2>Load libraries</h2>
</div>
<div id="data-cleaning" class="section level2">
<h2>Data cleaning</h2>
<pre class="r"><code>url &lt;- &quot;https://data.un.org/_Docs/SYB/CSV/SYB63_176_202003_Tourist-Visitors%20Arrival%20and%20Expenditure.csv&quot;

un_tourism_data &lt;- fread(input = url,
                         skip=1) %&gt;% 
  clean_names() %&gt;% 
  rename(country = v2) %&gt;% 
  select(-c(1,5,6,8,9))

# to save the data file, so you can load it locally
# write_csv(un_tourism_data, &quot;un_tourism_data.csv&quot;)

# un_tourism_data &lt;- read_csv(here::here(&quot;data&quot;, &quot;un_tourism_data&quot;))

skimr::skim(un_tourism_data)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">un_tourism_data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">2246</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">Key</td>
<td align="left">NULL</td>
</tr>
<tr class="odd">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">character</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">220</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">series</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">36</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2010.40</td>
<td align="right">7.87</td>
<td align="right">1995.0</td>
<td align="right">2005</td>
<td align="right">2016</td>
<td align="right">2017.0</td>
<td align="right">2018</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">value</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5786.48</td>
<td align="right">15137.84</td>
<td align="right">0.6</td>
<td align="right">199</td>
<td align="right">922</td>
<td align="right">4586.5</td>
<td align="right">256145</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code>tourism_wide &lt;-  un_tourism_data %&gt;% 
    pivot_wider(names_from = &quot;series&quot;,
              values_from = &quot;value&quot;) %&gt;% 
  clean_names() %&gt;% 
  rename(
    tourism_expenditure = tourism_expenditure_millions_of_us_dollars ,
    tourist_arrivals = tourist_visitor_arrivals_thousands    
  )


skim(tourism_wide)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tourism_wide</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1242</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">220</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2010.26</td>
<td align="right">8.04</td>
<td align="right">1995.0</td>
<td align="right">2005.00</td>
<td align="right">2010.0</td>
<td align="right">2017.0</td>
<td align="right">2018</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">tourism_expenditure</td>
<td align="right">156</td>
<td align="right">0.87</td>
<td align="right">6203.63</td>
<td align="right">18102.10</td>
<td align="right">0.6</td>
<td align="right">168.39</td>
<td align="right">838.0</td>
<td align="right">4586.5</td>
<td align="right">256145</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">tourist_arrivals</td>
<td align="right">82</td>
<td align="right">0.93</td>
<td align="right">5395.94</td>
<td align="right">11695.96</td>
<td align="right">0.9</td>
<td align="right">226.25</td>
<td align="right">1040.5</td>
<td align="right">4577.5</td>
<td align="right">89322</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code>tourism_wide &lt;- tourism_wide %&gt;% 
  filter(!is.na(tourism_expenditure), 
         !is.na(tourist_arrivals))

skim(tourism_wide)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tourism_wide</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1004</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">205</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2010.59</td>
<td align="right">7.66</td>
<td align="right">1995.0</td>
<td align="right">2005.00</td>
<td align="right">2016.0</td>
<td align="right">2017.00</td>
<td align="right">2018</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">tourism_expenditure</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6648.55</td>
<td align="right">18752.82</td>
<td align="right">1.2</td>
<td align="right">210.25</td>
<td align="right">963.5</td>
<td align="right">5436.00</td>
<td align="right">256145</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">tourist_arrivals</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5985.23</td>
<td align="right">12329.16</td>
<td align="right">1.1</td>
<td align="right">286.75</td>
<td align="right">1315.5</td>
<td align="right">5723.25</td>
<td align="right">89322</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code># create new variable that calculates spending per tourist
tourism_wide &lt;- tourism_wide %&gt;% 
  mutate(spending_per_tourist = 1000*tourism_expenditure/tourist_arrivals)


skim(tourism_wide)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tourism_wide</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1004</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">205</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2010.59</td>
<td align="right">7.66</td>
<td align="right">1995.00</td>
<td align="right">2005.00</td>
<td align="right">2016.00</td>
<td align="right">2017.00</td>
<td align="right">2018.0</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">tourism_expenditure</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6648.55</td>
<td align="right">18752.82</td>
<td align="right">1.20</td>
<td align="right">210.25</td>
<td align="right">963.50</td>
<td align="right">5436.00</td>
<td align="right">256145.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">tourist_arrivals</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5985.23</td>
<td align="right">12329.16</td>
<td align="right">1.10</td>
<td align="right">286.75</td>
<td align="right">1315.50</td>
<td align="right">5723.25</td>
<td align="right">89322.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">spending_per_tourist</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1134.55</td>
<td align="right">934.93</td>
<td align="right">8.94</td>
<td align="right">584.05</td>
<td align="right">910.77</td>
<td align="right">1426.90</td>
<td align="right">8376.3</td>
<td align="left">▇▂▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#Talk about a skewed distribution for spending_per_tourist: 
# from min of 9, to max of 8376$/tourist. mean = 1135, median = 911


tourism_long &lt;- tourism_wide %&gt;% 
  pivot_longer(cols = 3:5, #columns 3 to 5
               names_to = &quot;indicator&quot;,
               values_to = &quot;value&quot;)

skimr::skim(tourism_long)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tourism_long</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">3012</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">205</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">indicator</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">16</td>
<td align="right">20</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2010.59</td>
<td align="right">7.66</td>
<td align="right">1995.0</td>
<td align="right">2005.0</td>
<td align="right">2016.00</td>
<td align="right">2017.0</td>
<td align="right">2018</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">value</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4589.44</td>
<td align="right">13195.27</td>
<td align="right">1.1</td>
<td align="right">366.5</td>
<td align="right">979.22</td>
<td align="right">2862.3</td>
<td align="right">256145</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Turn `indicator` from character to a factor variable
tourism_long &lt;- tourism_long %&gt;% 
  mutate(
    indicator = factor(indicator, 
                       levels = c(&quot;tourist_arrivals&quot;, &quot;tourism_expenditure&quot;, &quot;spending_per_tourist&quot;),
                       labels = c(&quot;Tourist Arrivals (000s)&quot;, &quot;Tourism Expenditure (million $)&quot;, &quot;Spending per tourist($)&quot;))
  )


skimr::skim(tourism_long)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tourism_long</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">3012</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">factor</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">205</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">indicator</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="left">Tou: 1004, Tou: 1004, Spe: 1004</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2010.59</td>
<td align="right">7.66</td>
<td align="right">1995.0</td>
<td align="right">2005.0</td>
<td align="right">2016.00</td>
<td align="right">2017.0</td>
<td align="right">2018</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">value</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4589.44</td>
<td align="right">13195.27</td>
<td align="right">1.1</td>
<td align="right">366.5</td>
<td align="right">979.22</td>
<td align="right">2862.3</td>
<td align="right">256145</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div id="explore-the-relationship-between-tourist-arrivals-and-spending" class="section level2">
<h2>Explore the relationship between tourist arrivals and spending</h2>
<pre class="r"><code>tourism_long %&gt;% 
  filter(country %in% c(&quot;France&quot;, &quot;Spain&quot;, &quot;Italy&quot;, &quot;United Kingdom&quot;, &quot;Thailand&quot;, &quot;China&quot;)) %&gt;% 
  ggplot(aes(x=year, y = value, colour=country))+
  geom_line()+
  geom_point(size=0.5)+
  facet_grid(rows = vars(indicator),
             cols = vars(country), 
             scales = &quot;free&quot;)+
  theme_bw()+
  theme(legend.position = &quot;none&quot;)+
  scale_y_continuous(labels = scales::label_comma())+
  labs(
    title = &quot;Tourist Arrivals and Spending&quot;,
    caption = &quot;Source: UN&quot;,
    x = &quot;&quot;,
    y = &quot;&quot;
  )</code></pre>
<p><img src="/blogs/un_tourism_data_files/figure-html/tourist%20arrivals%20and%20spending-1.png" width="672" /></p>
</div>
<div id="calculate-growth-rates-starting-for-each-country-at-1-or-100" class="section level1">
<h1>Calculate growth rates, starting for each country at 1 (or 100%)</h1>
<pre class="r"><code>tourism_wide2 &lt;- tourism_wide  %&gt;% 
  group_by(country) %&gt;%
  mutate(
    delta_arrivals = (tourist_arrivals / lag(tourist_arrivals,1)),
    delta_expenditure = (tourism_expenditure/lag(tourism_expenditure,1 )), 
    delta_spending_per_tourist = (spending_per_tourist/lag(spending_per_tourist,1))
  ) %&gt;% 
  replace_na(list(
    delta_arrivals = 1,
    delta_expenditure = 1,
    delta_spending_per_tourist = 1
  )) %&gt;% 
  ungroup() %&gt;% 
  select(country, year, delta_arrivals, delta_expenditure, delta_spending_per_tourist)

# wide to long
tourism_long2 &lt;- tourism_wide2 %&gt;% 
  pivot_longer(cols = 3:5, #columns 3 to 5
               names_to = &quot;indicator&quot;,
               values_to = &quot;value&quot;)

skimr::skim(tourism_long)</code></pre>
<table>
<caption>(#tab:calculate growth rates)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tourism_long</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">3012</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">factor</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">205</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">indicator</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="left">Tou: 1004, Tou: 1004, Spe: 1004</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2010.59</td>
<td align="right">7.66</td>
<td align="right">1995.0</td>
<td align="right">2005.0</td>
<td align="right">2016.00</td>
<td align="right">2017.0</td>
<td align="right">2018</td>
<td align="left">▂▁▃▃▇</td>
</tr>
<tr class="even">
<td align="left">value</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4589.44</td>
<td align="right">13195.27</td>
<td align="right">1.1</td>
<td align="right">366.5</td>
<td align="right">979.22</td>
<td align="right">2862.3</td>
<td align="right">256145</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<div id="plot-changes-with-1100-as-starting-point-for-each-country" class="section level3">
<h3>Plot % changes, with 1=100% as starting point for each country</h3>
<pre class="r"><code>tourism_long2 %&gt;% 
  filter(country %in% c(&quot;France&quot;, &quot;Spain&quot;, &quot;Italy&quot;, &quot;United Kingdom&quot;, &quot;Thailand&quot;, &quot;China&quot;)) %&gt;% 
  ggplot(aes(x=year, y = value, colour=country))+
  geom_line()+
  geom_point(size=0.5)+
  facet_grid(rows = vars(indicator),
             cols = vars(country), 
             scales = &quot;free&quot;)+
  theme_bw()+
  theme(legend.position = &quot;none&quot;)+
  scale_y_continuous(labels = scales::label_percent())+
  labs(
    title = &quot;Changes in Tourist Arrivals and Spending&quot;,
    subtitle = &quot;Base year (100%) = 1995&quot;,
    caption = &quot;Source: UN&quot;,
    x = &quot;&quot;,
    y = &quot;&quot;
  )</code></pre>
<p><img src="/blogs/un_tourism_data_files/figure-html/plotchanges-1.png" width="672" /></p>
</div>
</div>
<div id="build-confidence-intervals-of-tourist-spending-not-by-country-but-rather-by-region" class="section level1">
<h1>Build confidence intervals of tourist spending not by country, but rather by region</h1>
<pre class="r"><code># First, get a string of all country names
countries &lt;- un_tourism_data %&gt;% 
  select(country) %&gt;% 
  distinct() %&gt;% 
  pull()

# Use countrycode package to convert names to iso3c https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3
# https://github.com/vincentarelbundock/countrycode
countrycodes &lt;- countries %&gt;% 
  countrycode(
    origin = &quot;country.name&quot;,
    destination = &quot;iso3c&quot;
  )</code></pre>
<pre><code>## Warning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest, : Some values were not matched unambiguously: Bonaire, Other non-specified areas, Saba, Sint Eustatius</code></pre>
<pre class="r"><code># create a tibble that has countries name and iso3c codes
countrycode_match &lt;- tibble(
  country = countries, 
  iso3c = countrycodes
)

# add iso3c code on dataframe, using a left join
un_tourism_details &lt;- left_join(un_tourism_data, countrycode_match, by = &quot;country&quot;)
glimpse(un_tourism_details)</code></pre>
<pre><code>## Rows: 2,246
## Columns: 5
## $ country &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;A…
## $ year    &lt;int&gt; 2010, 2016, 2017, 2018, 2010, 2016, 2017, 2018, 1995, 2005, 20…
## $ series  &lt;chr&gt; &quot;Tourism expenditure (millions of US dollars)&quot;, &quot;Tourism expen…
## $ value   &lt;dbl&gt; 147.0, 62.0, 16.0, 50.0, 2191.0, 4070.0, 4643.0, 5340.0, 70.0,…
## $ iso3c   &lt;chr&gt; &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;,…</code></pre>
<pre class="r"><code># Use wbstats::wb_countries to get regions and demographics on countries
wb_countries &lt;- wbstats::wb_countries()
glimpse(wb_countries)</code></pre>
<pre><code>## Rows: 299
## Columns: 18
## $ iso3c              &lt;chr&gt; &quot;ABW&quot;, &quot;AFE&quot;, &quot;AFG&quot;, &quot;AFR&quot;, &quot;AFW&quot;, &quot;AGO&quot;, &quot;ALB&quot;, &quot;A…
## $ iso2c              &lt;chr&gt; &quot;AW&quot;, &quot;ZH&quot;, &quot;AF&quot;, &quot;A9&quot;, &quot;ZI&quot;, &quot;AO&quot;, &quot;AL&quot;, &quot;AD&quot;, &quot;1A…
## $ country            &lt;chr&gt; &quot;Aruba&quot;, &quot;Africa Eastern and Southern&quot;, &quot;Afghanista…
## $ capital_city       &lt;chr&gt; &quot;Oranjestad&quot;, NA, &quot;Kabul&quot;, NA, NA, &quot;Luanda&quot;, &quot;Tiran…
## $ longitude          &lt;dbl&gt; -70.01670, NA, 69.17610, NA, NA, 13.24200, 19.81720…
## $ latitude           &lt;dbl&gt; 12.51670, NA, 34.52280, NA, NA, -8.81155, 41.33170,…
## $ region_iso3c       &lt;chr&gt; &quot;LCN&quot;, NA, &quot;SAS&quot;, NA, NA, &quot;SSF&quot;, &quot;ECS&quot;, &quot;ECS&quot;, NA, …
## $ region_iso2c       &lt;chr&gt; &quot;ZJ&quot;, NA, &quot;8S&quot;, NA, NA, &quot;ZG&quot;, &quot;Z7&quot;, &quot;Z7&quot;, NA, &quot;ZQ&quot;,…
## $ region             &lt;chr&gt; &quot;Latin America &amp; Caribbean&quot;, &quot;Aggregates&quot;, &quot;South A…
## $ admin_region_iso3c &lt;chr&gt; NA, NA, &quot;SAS&quot;, NA, NA, &quot;SSA&quot;, &quot;ECA&quot;, NA, NA, NA, &quot;L…
## $ admin_region_iso2c &lt;chr&gt; NA, NA, &quot;8S&quot;, NA, NA, &quot;ZF&quot;, &quot;7E&quot;, NA, NA, NA, &quot;XJ&quot;,…
## $ admin_region       &lt;chr&gt; NA, NA, &quot;South Asia&quot;, NA, NA, &quot;Sub-Saharan Africa (…
## $ income_level_iso3c &lt;chr&gt; &quot;HIC&quot;, NA, &quot;LIC&quot;, NA, NA, &quot;LMC&quot;, &quot;UMC&quot;, &quot;HIC&quot;, NA, …
## $ income_level_iso2c &lt;chr&gt; &quot;XD&quot;, NA, &quot;XM&quot;, NA, NA, &quot;XN&quot;, &quot;XT&quot;, &quot;XD&quot;, NA, &quot;XD&quot;,…
## $ income_level       &lt;chr&gt; &quot;High income&quot;, &quot;Aggregates&quot;, &quot;Low income&quot;, &quot;Aggrega…
## $ lending_type_iso3c &lt;chr&gt; &quot;LNX&quot;, NA, &quot;IDX&quot;, NA, NA, &quot;IBD&quot;, &quot;IBD&quot;, &quot;LNX&quot;, NA, …
## $ lending_type_iso2c &lt;chr&gt; &quot;XX&quot;, NA, &quot;XI&quot;, NA, NA, &quot;XF&quot;, &quot;XF&quot;, &quot;XX&quot;, NA, &quot;XX&quot;,…
## $ lending_type       &lt;chr&gt; &quot;Not classified&quot;, &quot;Aggregates&quot;, &quot;IDA&quot;, &quot;Aggregates&quot;…</code></pre>
<pre class="r"><code># there are quite a few NAs, so let us see how we handle them

be_careful_with_na_omit &lt;- left_join(un_tourism_details, wb_countries, by = &quot;iso3c&quot;) %&gt;% 
  na.omit()

un_tourism_final &lt;- left_join(un_tourism_details, wb_countries, by = &quot;iso3c&quot;) %&gt;% 
  filter(!is.na(region)) 
glimpse(un_tourism_final)</code></pre>
<pre><code>## Rows: 2,142
## Columns: 22
## $ country.x          &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afgha…
## $ year               &lt;int&gt; 2010, 2016, 2017, 2018, 2010, 2016, 2017, 2018, 199…
## $ series             &lt;chr&gt; &quot;Tourism expenditure (millions of US dollars)&quot;, &quot;To…
## $ value              &lt;dbl&gt; 147.0, 62.0, 16.0, 50.0, 2191.0, 4070.0, 4643.0, 53…
## $ iso3c              &lt;chr&gt; &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;A…
## $ iso2c              &lt;chr&gt; &quot;AF&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;AL&quot;, &quot;AL&quot;, &quot;AL&quot;, &quot;AL&quot;, &quot;AL…
## $ country.y          &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afgha…
## $ capital_city       &lt;chr&gt; &quot;Kabul&quot;, &quot;Kabul&quot;, &quot;Kabul&quot;, &quot;Kabul&quot;, &quot;Tirane&quot;, &quot;Tira…
## $ longitude          &lt;dbl&gt; 69.17610, 69.17610, 69.17610, 69.17610, 19.81720, 1…
## $ latitude           &lt;dbl&gt; 34.5228, 34.5228, 34.5228, 34.5228, 41.3317, 41.331…
## $ region_iso3c       &lt;chr&gt; &quot;SAS&quot;, &quot;SAS&quot;, &quot;SAS&quot;, &quot;SAS&quot;, &quot;ECS&quot;, &quot;ECS&quot;, &quot;ECS&quot;, &quot;E…
## $ region_iso2c       &lt;chr&gt; &quot;8S&quot;, &quot;8S&quot;, &quot;8S&quot;, &quot;8S&quot;, &quot;Z7&quot;, &quot;Z7&quot;, &quot;Z7&quot;, &quot;Z7&quot;, &quot;Z7…
## $ region             &lt;chr&gt; &quot;South Asia&quot;, &quot;South Asia&quot;, &quot;South Asia&quot;, &quot;South As…
## $ admin_region_iso3c &lt;chr&gt; &quot;SAS&quot;, &quot;SAS&quot;, &quot;SAS&quot;, &quot;SAS&quot;, &quot;ECA&quot;, &quot;ECA&quot;, &quot;ECA&quot;, &quot;E…
## $ admin_region_iso2c &lt;chr&gt; &quot;8S&quot;, &quot;8S&quot;, &quot;8S&quot;, &quot;8S&quot;, &quot;7E&quot;, &quot;7E&quot;, &quot;7E&quot;, &quot;7E&quot;, &quot;7E…
## $ admin_region       &lt;chr&gt; &quot;South Asia&quot;, &quot;South Asia&quot;, &quot;South Asia&quot;, &quot;South As…
## $ income_level_iso3c &lt;chr&gt; &quot;LIC&quot;, &quot;LIC&quot;, &quot;LIC&quot;, &quot;LIC&quot;, &quot;UMC&quot;, &quot;UMC&quot;, &quot;UMC&quot;, &quot;U…
## $ income_level_iso2c &lt;chr&gt; &quot;XM&quot;, &quot;XM&quot;, &quot;XM&quot;, &quot;XM&quot;, &quot;XT&quot;, &quot;XT&quot;, &quot;XT&quot;, &quot;XT&quot;, &quot;XT…
## $ income_level       &lt;chr&gt; &quot;Low income&quot;, &quot;Low income&quot;, &quot;Low income&quot;, &quot;Low inco…
## $ lending_type_iso3c &lt;chr&gt; &quot;IDX&quot;, &quot;IDX&quot;, &quot;IDX&quot;, &quot;IDX&quot;, &quot;IBD&quot;, &quot;IBD&quot;, &quot;IBD&quot;, &quot;I…
## $ lending_type_iso2c &lt;chr&gt; &quot;XI&quot;, &quot;XI&quot;, &quot;XI&quot;, &quot;XI&quot;, &quot;XF&quot;, &quot;XF&quot;, &quot;XF&quot;, &quot;XF&quot;, &quot;XF…
## $ lending_type       &lt;chr&gt; &quot;IDA&quot;, &quot;IDA&quot;, &quot;IDA&quot;, &quot;IDA&quot;, &quot;IBRD&quot;, &quot;IBRD&quot;, &quot;IBRD&quot;,…</code></pre>
<pre class="r"><code># We have &quot;country.x&quot; and &quot;country.y&quot; which are the two fields from the two dataframes we joined
un_tourism_final &lt;- un_tourism_final %&gt;% 
  select (-country.y) %&gt;% 
  rename(country = country.x)

un_tourism_wide &lt;- un_tourism_final %&gt;% 
  pivot_wider(names_from = &quot;series&quot;,
              values_from = &quot;value&quot;) %&gt;% 
  clean_names() %&gt;% 
  filter(!is.na(tourism_expenditure_millions_of_us_dollars), !is.na(tourist_visitor_arrivals_thousands)) %&gt;% 
  mutate(spending_per_tourist = 1000*tourism_expenditure_millions_of_us_dollars / tourist_visitor_arrivals_thousands)

glimpse(un_tourism_wide)</code></pre>
<pre><code>## Rows: 959
## Columns: 22
## $ country                                    &lt;chr&gt; &quot;Albania&quot;, &quot;Albania&quot;, &quot;Alba…
## $ year                                       &lt;int&gt; 2010, 2016, 2017, 2018, 200…
## $ iso3c                                      &lt;chr&gt; &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;,…
## $ iso2c                                      &lt;chr&gt; &quot;AL&quot;, &quot;AL&quot;, &quot;AL&quot;, &quot;AL&quot;, &quot;DZ…
## $ capital_city                               &lt;chr&gt; &quot;Tirane&quot;, &quot;Tirane&quot;, &quot;Tirane…
## $ longitude                                  &lt;dbl&gt; 19.81720, 19.81720, 19.8172…
## $ latitude                                   &lt;dbl&gt; 41.33170, 41.33170, 41.3317…
## $ region_iso3c                               &lt;chr&gt; &quot;ECS&quot;, &quot;ECS&quot;, &quot;ECS&quot;, &quot;ECS&quot;,…
## $ region_iso2c                               &lt;chr&gt; &quot;Z7&quot;, &quot;Z7&quot;, &quot;Z7&quot;, &quot;Z7&quot;, &quot;ZQ…
## $ region                                     &lt;chr&gt; &quot;Europe &amp; Central Asia&quot;, &quot;E…
## $ admin_region_iso3c                         &lt;chr&gt; &quot;ECA&quot;, &quot;ECA&quot;, &quot;ECA&quot;, &quot;ECA&quot;,…
## $ admin_region_iso2c                         &lt;chr&gt; &quot;7E&quot;, &quot;7E&quot;, &quot;7E&quot;, &quot;7E&quot;, &quot;XQ…
## $ admin_region                               &lt;chr&gt; &quot;Europe &amp; Central Asia (exc…
## $ income_level_iso3c                         &lt;chr&gt; &quot;UMC&quot;, &quot;UMC&quot;, &quot;UMC&quot;, &quot;UMC&quot;,…
## $ income_level_iso2c                         &lt;chr&gt; &quot;XT&quot;, &quot;XT&quot;, &quot;XT&quot;, &quot;XT&quot;, &quot;XN…
## $ income_level                               &lt;chr&gt; &quot;Upper middle income&quot;, &quot;Upp…
## $ lending_type_iso3c                         &lt;chr&gt; &quot;IBD&quot;, &quot;IBD&quot;, &quot;IBD&quot;, &quot;IBD&quot;,…
## $ lending_type_iso2c                         &lt;chr&gt; &quot;XF&quot;, &quot;XF&quot;, &quot;XF&quot;, &quot;XF&quot;, &quot;XF…
## $ lending_type                               &lt;chr&gt; &quot;IBRD&quot;, &quot;IBRD&quot;, &quot;IBRD&quot;, &quot;IB…
## $ tourism_expenditure_millions_of_us_dollars &lt;dbl&gt; 1778, 1821, 2050, 2306, 477…
## $ tourist_visitor_arrivals_thousands         &lt;dbl&gt; 2191.0, 4070.0, 4643.0, 534…
## $ spending_per_tourist                       &lt;dbl&gt; 811.50160, 447.42015, 441.5…</code></pre>
</div>
<div id="let-us-plot-the-distribution-of-spending-per-tourist-in-each-region" class="section level1">
<h1>Let us plot the distribution of spending per tourist in each region</h1>
<pre class="r"><code>un_tourism_wide %&gt;% 
  ggplot(aes(x=spending_per_tourist, colour=region)) +
  # geom_histogram()+
  geom_density()+
  facet_wrap(~region)+
  theme_bw()+
  theme(legend.position = &quot;none&quot;)+
  NULL</code></pre>
<p><img src="/blogs/un_tourism_data_files/figure-html/plot%20region%20data-1.png" width="672" /></p>
<pre class="r"><code># Construct a confidence interval of spending per tourist in each region
confidence_intervals &lt;- un_tourism_wide %&gt;% 
  group_by(region) %&gt;% 
  summarise(
    min_spending_per_tourist =  min(spending_per_tourist),
    max_spending_per_tourist =  max(spending_per_tourist),
    median_spending_per_tourist =  median(spending_per_tourist),
    mean_spending_per_tourist = mean(spending_per_tourist),
    sd_spending_per_tourist = sd(spending_per_tourist),
    count = n(),
    se_spending_per_tourist = sd_spending_per_tourist/ sqrt(count),
    t_critical = qt(0.975, count - 1 ),
    lower = mean_spending_per_tourist - t_critical * se_spending_per_tourist,
    upper = mean_spending_per_tourist + t_critical * se_spending_per_tourist
  ) %&gt;% 
  ungroup() %&gt;% 
  arrange(desc(mean_spending_per_tourist))

confidence_intervals %&gt;% 
  select(region, mean_spending_per_tourist, lower, upper) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">region</th>
<th align="right">mean_spending_per_tourist</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">North America</td>
<td align="right">2012.65</td>
<td align="right">1535.04</td>
<td align="right">2490.26</td>
</tr>
<tr class="even">
<td align="left">East Asia &amp; Pacific</td>
<td align="right">1366.85</td>
<td align="right">1202.87</td>
<td align="right">1530.83</td>
</tr>
<tr class="odd">
<td align="left">Latin America &amp; Caribbean</td>
<td align="right">1203.06</td>
<td align="right">1109.54</td>
<td align="right">1296.59</td>
</tr>
<tr class="even">
<td align="left">South Asia</td>
<td align="right">1201.47</td>
<td align="right">957.04</td>
<td align="right">1445.89</td>
</tr>
<tr class="odd">
<td align="left">Middle East &amp; North Africa</td>
<td align="right">1172.39</td>
<td align="right">872.95</td>
<td align="right">1471.83</td>
</tr>
<tr class="even">
<td align="left">Europe &amp; Central Asia</td>
<td align="right">1043.71</td>
<td align="right">934.47</td>
<td align="right">1152.95</td>
</tr>
<tr class="odd">
<td align="left">Sub-Saharan Africa</td>
<td align="right">876.23</td>
<td align="right">751.56</td>
<td align="right">1000.90</td>
</tr>
</tbody>
</table>
</div>
